#!/bin/bash
#
# Simple install script which downloads all necessary dependencies for
# GameKit development.
#
GAMEKIT_BASE_DIR=~/git
GAMEKIT_DEPENDENCIES_DIR=$GAMEKIT_BASE_DIR/GameKit-Dependencies

function install_brew
{
    /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
    brew install ccache
    brew install wget
}

#install_brew()
sudo gem install xcpretty
sudo gem install cocoapods --version=0.39.0

# @todo Check if Xcode exists.
echo
echo "Please download Xcode 7.1+"
# @todo Check if Android Studio exists.
echo
echo "Please download and install Android Studio 1.5+"

# Dependencies
mkdir -p $GAMEKIT_DEPENDENCIES_DIR
cd $GAMEKIT_DEPENDENCIES_DIR
if [ ! -f "$GAMEKIT_DEPENDENCIES_DIR/jdk-8u91-macosx-x64.dmg" ]; then
    echo "Downloading JDK... The JDK must be installed before Android Studio can be used!"
    wget http://download.oracle.com/otn-pub/java/jdk/8u91-b14/jdk-8u91-macosx-x64.dmg
fi
if [ ! -f "$GAMEKIT_DEPENDENCIES_DIR/android-ndk-r10c-darwin-x86_64.zip" ]; then
    echo "Downloading Android NDK..."
    wget http://dl.google.com/android/repository/android-ndk-r10c-darwin-x86_64.zip
    # @todo If this fails, display an error message.
    unzip android-ndk-r10c-darwin-x86_64.zip
    # @todo If the last command succeeded, remove the zip.
    #rm -rf android-ndk-r10c-darwin-x86_64.zip
fi
cd -

# GameKit
# @todo Make a method that performs all of these operations.
cd $GAMEKIT_BASE_DIR
if [ ! -d "$GAMEKIT_BASE_DIR/GameKit" ]; then
    git clone https://github.com/PeqNP/GameKit.git
    # @todo If command fails, display error and quit.
fi
if [ ! -d "$GAMEKIT_BASE_DIR/GameKit-Android" ]; then
    git clone https://github.com/PeqNP/GameKit-Android.git
fi
if [ ! -d "$GAMEKIT_BASE_DIR/GameKit-iOS" ]; then
    git clone https://github.com/PeqNP/GameKit-iOS.git
fi
cd -

echo "Add the following to ~/.bash_profile"
echo "export PATH=/usr/local/opt/ccache/libexec:\$PATH"
echo "export PATH=/Users/eric/git/GameKit/bin:\$PATH"
